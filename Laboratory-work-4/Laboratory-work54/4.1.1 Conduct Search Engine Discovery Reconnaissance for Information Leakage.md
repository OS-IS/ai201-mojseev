### 4.1.1 Проведення розвідки через пошукові системи для виявлення витоків інформації
# Проведення розвідки через пошукові системи для виявлення витоків інформації
## ID
WSTG-INFO-01

## Резюме
Для роботи пошукових систем комп'ютерні програми (або роботи) регулярно збирають дані (процес, відомий як "кроулінг") з мільярдів сторінок в Інтернеті. Ці програми знаходять веб-контент і функціональність, слідуючи за посиланнями з інших сторінок або переглядаючи карти сайтів (sitemaps). Якщо вебсайт використовує спеціальний файл, званий **robots.txt**, щоб вказати сторінки, які він не хоче, щоб пошукові системи збирали, то ці сторінки будуть проігноровані. Це базовий огляд — Google пропонує більш детальне пояснення того, як працює пошукова система.

Тестувальники можуть використовувати пошукові системи для проведення розвідки вебсайтів і веб-додатків. Є прямі та непрямі елементи пошукової розвідки: прямі методи пов'язані з пошуком в індексах та вмістом з кешів, а непрямі методи включають вивчення чутливої інформації про дизайн і конфігурацію через форуми, новинні групи та сайти оголошень.

Після того, як пошуковий робот завершить кроулінг, він починає індексацію веб-контенту на основі тегів та асоційованих атрибутів, таких як `<TITLE>`, щоб повернути відповідні результати пошуку. Якщо файл **robots.txt** не оновлювався протягом часу існування вебсайту і не були використані вбудовані HTML мета-теги, що інструктують роботи не індексувати контент, то є ймовірність, що в індексах з'явиться веб-контент, який власники не бажають включати. Власники сайтів можуть використовувати вищезгадані **robots.txt**, HTML мета-теги, аутентифікацію та інструменти, що надаються пошуковими системами, для видалення такого контенту.

## Цілі тестування
- Виявити чутливу інформацію про дизайн і конфігурацію застосунку, системи або організації, яка може бути відкрито (на сайті організації) або опосередковано (через сторонні сервіси).

## Як проводити тестування
Використовуйте пошукову систему для пошуку потенційно чутливої інформації. Це може включати:

- діаграми та конфігурації мереж;
- архівовані повідомлення та електронні листи адміністраторами або іншими ключовими співробітниками;
- процедури входу та формати імен користувачів;
- імена користувачів, паролі та приватні ключі;
- конфігураційні файли сторонніх або хмарних сервісів;
- інформацію з помилок сервера;
- версії сайтів для розробки, тестування, користувацького приймання (UAT) і стадії.

## Пошукові системи
Не обмежуйте тестування лише однією пошуковою системою, оскільки різні системи можуть генерувати різні результати. Результати пошуку можуть відрізнятися в залежності від того, коли система останній раз виконувала кроулінг контенту та алгоритму, який вона використовує для визначення релевантних сторінок. Рекомендується використовувати наступні пошукові системи:

- **Baidu** — найбільш популярна пошукова система в Китаї.
- **Bing** — пошукова система, що належить Microsoft, друга за популярністю у світі. Підтримує розширені ключові слова для пошуку.
- **binsearch.info** — пошукова система для бінарних Usenet новинних груп.
- **Common Crawl** — "відкрите сховище даних веб-кроулінгу, яке можна отримати та аналізувати будь-кому".
- **DuckDuckGo** — пошукова система, орієнтована на конфіденційність, що збирає результати з багатьох різних джерел. Підтримує синтаксис пошуку.
- **Google** — найбільш популярна пошукова система у світі, яка використовує систему рейтингу для надання найбільш релевантних результатів. Підтримує оператори пошуку.
- **Internet Archive Wayback Machine** — "будує цифрову бібліотеку Інтернет-сайтів та інших культурних артефактів у цифровій формі".
- **Startpage** — пошукова система, яка використовує результати Google без збору особистої інформації через трекери та логи. Підтримує оператори пошуку.
- **Shodan** — сервіс для пошуку Інтернет-підключених пристроїв та сервісів.

Як DuckDuckGo, так і Startpage пропонують підвищену конфіденційність для користувачів, оскільки вони не використовують трекери або зберігають логи. Це може забезпечити зниження витоку інформації про тестувальника.

## Оператори пошуку
Оператор пошуку — це спеціальне ключове слово або синтаксис, який розширює можливості звичайних пошукових запитів і допомагає отримувати більш конкретні результати. Вони зазвичай мають форму `оператор:запит`. Ось деякі часто використовувані оператори пошуку:

- `site:` — обмежує пошук до наданого домену.
- `inurl:` — повертає лише результати, що містять ключове слово в URL.
- `intitle:` — повертає лише результати, де є ключове слово в заголовку сторінки.
- `intext:` або `inbody:` — шукає ключове слово тільки в тілі сторінки.
- `filetype:` — шукає лише за певним типом файлу, наприклад, png або php.

Наприклад, щоб знайти веб-контент owasp.org, який індексується типовою пошуковою системою, необхідний синтаксис:

[owasp.org](https://owasp.org)

## Перегляд кешованого контенту
Для пошуку контенту, який вже був індексований, використовуйте оператор `cache:`. Це корисно для перегляду контенту, який міг змінитися з часу індексації або вже недоступний. Не всі пошукові системи надають кешований контент для пошуку; найбільш корисним джерелом на момент написання є Google.

Щоб переглянути owasp.org, як він кешований, використовуйте синтаксис:

cache:owasp.org

## Google Hacking або Dorking
Пошук з операторами може бути дуже ефективною технікою розвідки, коли комбінується з креативністю тестувальника. Оператори можна поєднувати, щоб ефективно виявляти специфічні види чутливих файлів та інформації. Цю техніку називають **Google hacking** або **Dorking**, і вона також можлива з іншими пошуковими системами, якщо ці системи підтримують оператори пошуку.

База даних **dorks**, така як Google Hacking Database, є корисним ресурсом, що може допомогти виявляти специфічну інформацію. Деякі категорії dorks включають:

- Вхідні точки (Footholds)
- Файли з іменами користувачів
- Чутливі директорії
- Виявлення веб-серверів
- Уразливі файли
- Уразливі сервери
- Повідомлення про помилки
- Файли з важливою інформацією
- Файли з паролями
- Чутлива інформація про онлайн-покупки
- Бази даних для інших пошукових систем, таких як Bing і Shodan, доступні в проектах, таких як **Google Hacking Diggity Project** від Bishop Fox.

## Виправлення
- Уважно оцінюйте чутливість інформації про дизайн і конфігурацію перед її публікацією в Інтернеті.
- Періодично перевіряйте чутливість вже опублікованої інформації про дизайн і конфігурацію.

